<scriptedContentFragments>
	<scriptedContentFragment name="${resource:NotificationList_Name}" version="10.1.8.10498" description="" instanceIdentifier="39aa3e84a898400d84f1fd7b8a2c033f" theme="" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="notification-list">
		<contentScript><![CDATA[#if (!$core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
	$core_v2_widget.Hide()
#end

#set($inSidebar = true)
#if ($core_v2_widget.RegionName == 'content' || $core_v2_widget.RegionName == 'header' || $core_v2_widget.RegionName == 'footer')
    #set($inSidebar = false)
    <div class="view">
        <div>
            <select class="ui-select" data-query="w_ncid">
                <option value="">$core_v2_language.GetResource('filter_all_categories')</option>
                #foreach($nc in $core_v2_notificationCategory.List())
                    <option value="$nc.Id">$nc.Name</option>
                #end
            </select>
            <select class="ui-select" data-query="w_nr">
                <option value="">$core_v2_language.GetResource('filter_anyreadstatus')</option>
                <option value="false">$core_v2_language.GetResource('filter_unreadonly')</option>
                <option value="true">$core_v2_language.GetResource('filter_readonly')</option>
            </select>
        </div>
    </div>
    <div class="message norecords">$core_v2_language.GetResource('no_notifications_filtered')</div>
#else
    <div class="message norecords">$core_v2_language.GetResource('no_notifications')</div>
#end

$core_v2_widget.ExecuteFile('list.vm')

<div class="ui-loading"></div>

#registerEndOfPageHtml('telligent.evolution.widgets.notificationList')
	<script type="text/javascript" src="$core_v2_encoding.HtmlAttributeEncode($core_v2_widget.GetFileUrl("ui.js"))"></script>
#end
#registerEndOfPageHtml()
	<script type="text/javascript">
		jQuery(function(){
			jQuery.telligent.evolution.widgets.notificationList.register({
				wrapper: jQuery('#$core_v2_widget.WrapperElementId'),
				moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('list.vm'))',
				conversationNotificationTypeId: '$core_v2_conversationMessage.NotificationTypeId.ToString()',
				pageIndexKey: '$core_v2_ui.PageIndexQueryStringKey()',
				hasMore: #if ($hasMore) true #else false #end,
				infiniteScroll: #if ($inSidebar) false #else true #end,
				query: {
				    w_ncid: '',
				    w_nr: ''
				},
				maxItems: #if($inSidebar) 10 #else -1 #end
			});
		})
	</script>
#end
]]></contentScript>
		<headerScript><![CDATA[
$core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('fragmentHeader', '${resource:NotificationList_Name}'))
		]]></headerScript>
		<configuration><![CDATA[
<propertyGroup id="options" resourceName="Options">
		<property id="fragmentHeader" resourceName="CF_Title" dataType="string" defaultValue="${resource:notifications}" controlType="Telligent.Evolution.Controls.ContentFragmentTokenStringControl, Telligent.Evolution.Platform" />
</propertyGroup>
		]]></configuration>
		<languageResources><language key="en-us">
  <resource name="CF_Title">Widget Title</resource>
  <resource name="filter_all_categories">All notifications</resource>
  <resource name="filter_anyreadstatus">With any read status</resource>
  <resource name="filter_readonly">That are read</resource>
  <resource name="filter_unreadonly">That aren't read</resource>
  <resource name="mark">Mark as read</resource>
  <resource name="no_notifications">No notifications. Go get busy in the community!</resource>
  <resource name="no_notifications_filtered">You don't have any notifications that match your filter.</resource>
  <resource name="NotificationList_Name">Notifications List</resource>
  <resource name="notifications">Notifications</resource>
  <resource name="Options">Options</resource>
</language>
<language key="zh-cn">
  <resource name="CF_Title">小组件标题</resource>
  <resource name="no_notifications">无通知。积极使用社区!</resource>
  <resource name="NotificationList_Name">通知列表</resource>
  <resource name="notifications">通知</resource>
  <resource name="Options">选项</resource>
</language>
<language key="zh-tw">
  <resource name="CF_Title">Widget 標題</resource>
  <resource name="no_notifications">沒有通知。立即加入社群!</resource>
  <resource name="NotificationList_Name">通知清單</resource>
  <resource name="notifications">通知</resource>
  <resource name="Options">選項</resource>
</language></languageResources>
		<files>
			<file name="list.vm">I3NldCAoJG5jaWQgPSBmYWxzZSkNCiNzZXQgKCRuY2lkID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X25jaWQnKSkNCiNzZXQgKCRpc1JlYWQgPSAnJykNCiNzZXQgKCRpc1JlYWQgPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfbnInKSkNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml91aS5HZXRDdXJyZW50UGFnZUluZGV4KCkpDQojc2V0ICgkcGFnZVNpemUgPSAxMCkNCg0KI3NldCgkaW5TaWRlYmFyID0gdHJ1ZSkNCiNpZiAoJGNvcmVfdjJfd2lkZ2V0LlJlZ2lvbk5hbWUgPT0gJ2NvbnRlbnQnIHx8ICRjb3JlX3YyX3dpZGdldC5SZWdpb25OYW1lID09ICdoZWFkZXInIHx8ICRjb3JlX3YyX3dpZGdldC5SZWdpb25OYW1lID09ICdmb290ZXInKQ0KICAgICNzZXQoJGluU2lkZWJhciA9IGZhbHNlKQ0KICAgICNzZXQoJHBhZ2VTaXplID0gMjApDQojZW5kDQoNCiNzZXQgKCRvcHRpb25zID0gIiV7IFBhZ2VJbmRleCA9ICRwYWdlSW5kZXgsIFBhZ2VTaXplID0gJHBhZ2VTaXplIH0iKQ0KI2lmICgkbmNpZCkNCiAgICAkb3B0aW9ucy5BZGQoJ05vdGlmaWNhdGlvbkNhdGVnb3J5SWQnLCAkbmNpZCkNCiNlbmQNCg0KI2lmICgkaXNSZWFkLkxlbmd0aCA+IDApDQogICAgJG9wdGlvbnMuQWRkKCdJc1JlYWQnLCAkaXNSZWFkKQ0KI2VuZA0KI3NldCgkbm90aWZpY2F0aW9ucyA9ICRjb3JlX3YyX25vdGlmaWNhdGlvbi5MaXN0KCRvcHRpb25zKSkNCg0KI2lmICgkbm90aWZpY2F0aW9ucy5QYWdlSW5kZXggIT0gJHBhZ2VJbmRleCkNCiAgICAkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQoNCiNzZXQgKCRoYXNNb3JlID0gZmFsc2UpDQojc2V0ICgkY3VycmVudFBhZ2VkUXVhbnRpdHkgPSAoJG5vdGlmaWNhdGlvbnMuUGFnZUluZGV4ICsgMSkgKiAkbm90aWZpY2F0aW9ucy5QYWdlU2l6ZSkNCiNpZiAoJG5vdGlmaWNhdGlvbnMuVG90YWxDb3VudCA+ICRjdXJyZW50UGFnZWRRdWFudGl0eSkNCiAgICAjc2V0ICgkaGFzTW9yZSA9IHRydWUpDQojZW5kDQoNCiNzZXQgKCRyZXBsYWNlbWVudE9wdGlvbnMgPSAkY29yZV92Ml91dGlsaXR5Lk1ha2VMaXN0KCdJZ25vcmVDYXNlJywgJ1NpbmdsZWxpbmUnKSkNCiNmb3JlYWNoKCRub3RpZmljYXRpb24gaW4gJG5vdGlmaWNhdGlvbnMpDQojYmVmb3JlYWxsDQoJPHVsIGNsYXNzPSJjb250ZW50LWxpc3QgY29udGVudCBtYXJnaW4tYm90dG9tIj4NCiNlYWNoDQoJI3NldCAoJGxhc3RBY3RvciA9IGZhbHNlKQ0KCSNzZXQgKCRhY3RvcnMgPSAkbm90aWZpY2F0aW9uLkFjdG9ycykNCgkjc2V0ICgkbGFzdEluZGV4ID0gJGFjdG9ycy5Db3VudCAtIDEpDQoJI3NldCAoJGxhc3RBY3RvciA9ICRhY3RvcnMuZ2V0X2l0ZW0oJGxhc3RJbmRleCkuVXNlcikNCgkjc2V0ICgkbm90aWZpY2F0aW9uVHlwZSA9ICRjb3JlX3YyX25vdGlmaWNhdGlvblR5cGUuR2V0KCRub3RpZmljYXRpb24uTm90aWZpY2F0aW9uVHlwZUlkKSkNCg0KCSNpZiAoJG5vdGlmaWNhdGlvblR5cGUuTm90aWZpY2F0aW9uVHlwZUlkID09ICRjb3JlX3YyX3JhdGVkSXRlbS5Ob3RpZmljYXRpb25UeXBlSWQpDQoJCSNzZXQgKCRsYXN0QWN0b3IgPSBmYWxzZSkNCgkjZW5kDQoNCgkjc2V0ICgkbm90aWZpY2F0aW9uTWVzc2FnZSA9IGZhbHNlKQ0KCSNzZXQgKCRub3RpZmljYXRpb25NZXNzYWdlID0gJG5vdGlmaWNhdGlvbi5NZXNzYWdlKCdIdG1sJykpDQoJI2lmICgkbm90aWZpY2F0aW9uTWVzc2FnZSkNCiAgICAJPGxpIGNsYXNzPSJjb250ZW50LWl0ZW0gbm90aWZpY2F0aW9uI2lmICghJGxhc3RBY3Rvcikgbm8tYXV0aG9yICNlbmQjaWYoISRub3RpZmljYXRpb24uSXNSZWFkKSB1bnJlYWQjZW5kIg0KCQlkYXRhLW5vdGlmaWNhdGlvbmlkPSIkbm90aWZpY2F0aW9uLk5vdGlmaWNhdGlvbklkIg0KCQlkYXRhLW5vdGlmaWNhdGlvbnR5cGVpZD0iJG5vdGlmaWNhdGlvbi5Ob3RpZmljYXRpb25UeXBlSWQiDQogICAgCQlkYXRhLXRhcmdldHVybD0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkbm90aWZpY2F0aW9uLlRhcmdldFVybCkiDQogICAgCQkjaWYoJGhhc01vcmUpIGRhdGEtaGFzbW9yZT0idHJ1ZSIgI2VuZA0KICAgIAkJPg0KCQkjaWYgKCRsYXN0QWN0b3IpDQoJCQk8ZGl2IGNsYXNzPSJwb3N0LWF1dGhvciI+DQoJCQkJPHNwYW4gY2xhc3M9ImF2YXRhciI+DQoJCQkJCSNpZiAoJGxhc3RBY3Rvci5Qcm9maWxlVXJsKQ0KCQkJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkbGFzdEFjdG9yLlByb2ZpbGVVcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayB2aWV3LXVzZXItcHJvZmlsZSI+DQoJCQkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkbGFzdEFjdG9yLkF2YXRhclVybCwgNDAsIDQwLCAiJXtib3JkZXI9JzBweCcsIGFsdD0kbGFzdEFjdG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2QgPSAnWm9vbUFuZENyb3AnIH0iKQ0KCQkJCQkJPC9hPg0KCQkJCQkjZWxzZQ0KCQkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkbGFzdEFjdG9yLkF2YXRhclVybCwgNDAsIDQwLCAiJXtib3JkZXI9JzBweCcsIGFsdD0kbGFzdEFjdG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2QgPSAnWm9vbUFuZENyb3AnIH0iKQ0KCQkJCQkjZW5kDQoJCQkJPC9zcGFuPg0KCQkJCTxzcGFuIGNsYXNzPSJ1c2VyLW5hbWUiPg0KCQkJCQkjaWYgKCRsYXN0QWN0b3IuUHJvZmlsZVVybCkNCgkJCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGxhc3RBY3Rvci5Qcm9maWxlVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPg0KCQkJCQkJCSRsYXN0QWN0b3IuRGlzcGxheU5hbWUNCgkJCQkJCTwvYT4NCgkJCQkJI2Vsc2UNCgkJCQkJCSRsYXN0QWN0b3IuRGlzcGxheU5hbWUNCgkJCQkJI2VuZA0KCQkJCTwvc3Bhbj4NCgkJCTwvZGl2Pg0KCQkjZW5kDQoJCTxkaXYgY2xhc3M9ImNvbnRlbnQiPg0KICAgIAkJCSNpZiAoJGluU2lkZWJhcikNCiAgICAJCQkgICAgJGNvcmVfdjJfdXRpbGl0eS5SZXBsYWNlKCRub3RpZmljYXRpb25NZXNzYWdlLCAnPChcLyk/YSg/PVxzfD4pW14+XSo+JywgJzwkMWI+JywgIiV7IFJlZ2V4T3B0aW9ucyA9ICRyZXBsYWNlbWVudE9wdGlvbnMgfSIpDQogICAgCQkJI2Vsc2UNCiAgICAJCQkgICAgJG5vdGlmaWNhdGlvbk1lc3NhZ2UNCiAgICAJCQkjZW5kDQoJCTwvZGl2Pg0KCQk8ZGl2IGNsYXNzPSJwb3N0LWRhdGUiPg0KCQkJJGNvcmVfdjJfdWkuQWdvRGF0ZSgkbm90aWZpY2F0aW9uLkxhc3RVcGRhdGVkRGF0ZSkNCgkJPC9kaXY+DQoJCTxkaXYgY2xhc3M9Im5vdGlmaWNhdGlvbi1jYXRlZ29yeSI+DQoJCQkkbm90aWZpY2F0aW9uLk5vdGlmaWNhdGlvbkNhdGVnb3J5Lk5hbWUNCgkJPC9kaXY+DQogICAgCQkjaWYoISRub3RpZmljYXRpb24uSXNSZWFkKQ0KICAgIAkJCTxkaXYgY2xhc3M9Im1hcmsiPg0KICAgIAkJCQk8YSBocmVmPSIjIiBjbGFzcz0idWktdGlwIiBkYXRhLW1lc3NhZ2VuYW1lPSJ0ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMudGhyZWFkLmhpZGVhdHRhY2htZW50Ij4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbWFyaycpPC9hPg0KICAgIAkJCTwvZGl2Pg0KICAgIAkJI2VuZA0KCTwvbGk+DQogICAgI2VuZA0KI2FmdGVyYWxsDQoJPC91bD4NCiNlbmQNCg==</file>
			<file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCl7DQoNCiAgICBmdW5jdGlvbiBsb2FkTmV4dChvcHRpb25zKSB7DQogICAgICAgIGlmKG9wdGlvbnMuaXNMb2FkaW5nTW9yZSB8fCAhb3B0aW9ucy5oYXNNb3JlKQ0KCQkJcmV0dXJuOw0KDQoJCW9wdGlvbnMuaXNMb2FkaW5nTW9yZSA9IHRydWU7DQoJCW9wdGlvbnMubG9hZGluZy5zaG93KCk7DQoNCgkJdmFyIGRhdGEgPSAkLmV4dGVuZCh7fSwgb3B0aW9ucy5xdWVyeSk7DQoJCWRhdGFbb3B0aW9ucy5wYWdlSW5kZXhLZXldID0gb3B0aW9ucy5wYWdlSW5kZXggKyAxOw0KDQoJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJdXJsOiBvcHRpb25zLm1vcmVVcmwsDQoJCQlkYXRhOiBkYXRhDQoJCX0pDQoJCSAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSl7DQoJCQkJdmFyIGl0ZW1zID0gJChyZXNwb25zZSkuZmluZCgnbGkuY29udGVudC1pdGVtJyk7DQoJCQkJaWYgKGl0ZW1zLmxlbmd0aCA+IDApIHsNCiAgICAJCQkJb3B0aW9ucy5oYXNNb3JlID0gaXRlbXMuZGF0YSgnaGFzbW9yZScpID09PSB0cnVlOw0KICAgIAkJCQlvcHRpb25zLmxpc3QuYXBwZW5kKGl0ZW1zKTsNCiAgICAJCQkJb3B0aW9ucy5wYWdlSW5kZXgrKzsNCiAgICAJCQkJb3B0aW9ucy5ub1Jlc3VsdHMuaGlkZSgpOw0KCQkJCX0gZWxzZSB7DQoJCQkJICAgIG9wdGlvbnMuaGFzTW9yZSA9IGZhbHNlOw0KCQkJCSAgICBpZiAob3B0aW9ucy5wYWdlSW5kZXggPT0gLTEpIHsNCgkJCQkgICAgICAgIG9wdGlvbnMubm9SZXN1bHRzLnNob3coKTsNCgkJCQkgICAgfQ0KCQkJCX0NCgkJCX0pDQoJCQkuYWx3YXlzKGZ1bmN0aW9uKCkgew0KCQkJICAgIG9wdGlvbnMuaXNMb2FkaW5nTW9yZSA9IGZhbHNlOw0KCQkJICAgIG9wdGlvbnMubG9hZGluZy5oaWRlKCk7DQoJCQl9KTsNCiAgICB9DQogICAgDQogICAgZnVuY3Rpb24gcmVzZXQob3B0aW9ucykgew0KICAgICAgICBvcHRpb25zLmlzTG9hZGluZ01vcmUgPSBmYWxzZTsNCiAgICAgICAgb3B0aW9ucy5oYXNNb3JlID0gdHJ1ZTsNCiAgICAgICAgb3B0aW9ucy5wYWdlSW5kZXggPSAtMTsNCiAgICAgICAgb3B0aW9ucy5saXN0LmVtcHR5KCk7DQogICAgICAgIG9wdGlvbnMucGFnZVVudGlsU2Nyb2xsQXR0ZW1wdHMgPSA1Ow0KICAgICAgICBpZiAob3B0aW9ucy5pbmZpbml0ZVNjcm9sbCkgew0KICAgICAgICAgICAgcGFnZVVudGlsU2Nyb2xscyhvcHRpb25zKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGxvYWROZXh0KG9wdGlvbnMpOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHBhZ2VVbnRpbFNjcm9sbHMob3B0aW9ucykgew0KICAgICAgICBpZiAob3B0aW9ucy5wYWdlVW50aWxTY3JvbGxBdHRlbXB0cyA+IDAgJiYgb3B0aW9ucy5saXN0Lm91dGVySGVpZ2h0KHRydWUpIDwgJCgnYm9keScpLmhlaWdodCgpKSB7DQogICAgICAgICAgICBvcHRpb25zLnBhZ2VVbnRpbFNjcm9sbEF0dGVtcHRzLS07DQogICAgICAgICAgICBvcHRpb25zLnBhZ2VJbmRleCsrOw0KICAgICAgICAgICAgb3B0aW9ucy5pc0xvYWRpbmdNb3JlID0gdHJ1ZTsNCiAgICAgICAgICAgIG9wdGlvbnMubG9hZGluZy5zaG93KCk7DQoNCiAgICAJCXZhciBkYXRhID0gJC5leHRlbmQoe30sIG9wdGlvbnMucXVlcnkpOw0KICAgIAkJZGF0YVtvcHRpb25zLnBhZ2VJbmRleEtleV0gPSBvcHRpb25zLnBhZ2VJbmRleCArIDE7DQogICAgDQogICAgCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCiAgICAJCQl1cmw6IG9wdGlvbnMubW9yZVVybCwNCiAgICAJCQlkYXRhOiBkYXRhDQogICAgCQl9KQ0KICAgIAkJICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXsNCiAgICAJCQkJdmFyIGl0ZW1zID0gJChyZXNwb25zZSkuZmluZCgnbGkuY29udGVudC1pdGVtJyk7DQogICAgCQkJCWlmIChpdGVtcy5sZW5ndGggPiAwKSB7DQogICAgICAgIAkJCQlvcHRpb25zLmhhc01vcmUgPSBpdGVtcy5kYXRhKCdoYXNtb3JlJykgPT09IHRydWU7DQogICAgICAgIAkJCQlvcHRpb25zLmxpc3QuYXBwZW5kKGl0ZW1zKTsNCiAgICAgICAgCQkJCW9wdGlvbnMucGFnZUluZGV4Kys7DQogICAgICAgIAkJCQlvcHRpb25zLm5vUmVzdWx0cy5oaWRlKCk7DQogICAgCQkJCX0gZWxzZSB7DQogICAgCQkJCSAgICBvcHRpb25zLmhhc01vcmUgPSBmYWxzZTsNCiAgICAJCQkJICAgIGlmIChvcHRpb25zLnBhZ2VJbmRleCA9PSAwKSB7DQogICAgCQkJCSAgICAgICAgb3B0aW9ucy5ub1Jlc3VsdHMuc2hvdygpOw0KICAgIAkJCQkgICAgfQ0KICAgIAkJCQl9DQogICAgCQkJCQ0KICAgIAkJCQlpZiAob3B0aW9ucy5oYXNNb3JlKSB7DQogICAgICAgICAgICAgICAgICAgICAgIHBhZ2VVbnRpbFNjcm9sbHMob3B0aW9ucyk7DQogICAgICAgICAgICAgICAgICAgIH0gDQogICAgCQkJfSkNCiAgICAJCQkuYWx3YXlzKGZ1bmN0aW9uKCkgew0KICAgIAkJCSAgICBvcHRpb25zLmlzTG9hZGluZ01vcmUgPSBmYWxzZTsNCiAgICAJCQkgICAgb3B0aW9ucy5sb2FkaW5nLmhpZGUoKTsNCiAgICAJCQl9KTsNCiAgICAgICAgfQ0KICAgIH0NCg0KCXZhciBhcGkgPSB7DQoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7DQoJCSAgICBvcHRpb25zLmlzTG9hZGluZ01vcmUgPSBmYWxzZTsNCgkJICAgIG9wdGlvbnMucGFnZUluZGV4ID0gMDsNCgkJICAgIG9wdGlvbnMubG9hZGluZyA9ICQoJy51aS1sb2FkaW5nJywgb3B0aW9ucy53cmFwcGVyKS5oaWRlKCk7DQogICAgCQlvcHRpb25zLmxpc3QgPSAkKCd1bC5jb250ZW50LWxpc3QnLCBvcHRpb25zLndyYXBwZXIpOw0KICAgIAkJb3B0aW9ucy5ub1Jlc3VsdHMgPSAkKCcubWVzc2FnZS5ub3JlY29yZHMnLCBvcHRpb25zLndyYXBwZXIpLmhpZGUoKTsNCgkJICAgIA0KCQkJb3B0aW9ucy53cmFwcGVyLm9uKCdjbGljaycsICdsaS5ub3RpZmljYXRpb24nLCBmdW5jdGlvbihlKXsNCgkJCQl2YXIgbiA9ICQodGhpcyk7DQoJCQkJdmFyIHVybCA9IG4uZGF0YSgndGFyZ2V0dXJsJyk7DQoJCQkJaWYgKG4uaGFzQ2xhc3MoJ3VucmVhZCcpKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5wdXQoew0KCQkJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvbm90aWZpY2F0aW9uL3tOb3RpZmljYXRpb25JZH0uanNvbicsDQoJCQkJCQlkYXRhOiB7DQoJCQkJCQkJTm90aWZpY2F0aW9uSWQ6IG4uZGF0YSgnbm90aWZpY2F0aW9uaWQnKSwNCgkJCQkJCQlNYXJrQXNSZWFkOiAnVHJ1ZScNCgkJCQkJCX0sDQoJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7DQoJCQkJCQkJbi5yZW1vdmVDbGFzcygndW5yZWFkJyk7DQoJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5wdWJsaXNoKCdub3RpZmljYXRpb24ucmVhZCcsIHsNCgkJCQkJCQkJdHlwZUlkOiBuLmRhdGEoJ25vdGlmaWNhdGlvbnR5cGVpZCcpLA0KCQkJCQkJCQl1bnJlYWRDb3VudDogJy09MScNCgkJCQkJCQl9LCB7IGNyb3NzV2luZG93OiB0cnVlIH0pOw0KCQkJCQkJCWlmICh1cmwpIHsNCgkJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnVybC5uYXZpZ2F0ZVRvKHVybCk7DQoJCQkJCQkJfQ0KCQkJCQkJfQ0KCQkJCQl9KTsNCgkJCQl9IGVsc2UgaWYgKHVybCkgew0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24udXJsLm5hdmlnYXRlVG8odXJsKTsNCgkJCQl9DQoJCQl9KTsNCgkJCQ0KCQkJJCgnc2VsZWN0Jywgb3B0aW9ucy53cmFwcGVyKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7DQoJCQkJdmFyIHMgPSAkKHRoaXMpOw0KCQkJCW9wdGlvbnMucXVlcnlbcy5kYXRhKCdxdWVyeScpXSA9IHMudmFsKCk7DQoJCQkJcmVzZXQob3B0aW9ucyk7DQoJCQl9KTsNCg0KCQkJaWYgKG9wdGlvbnMuaW5maW5pdGVTY3JvbGwpIHsNCiAgICAgICAgCQkkKGRvY3VtZW50KS5vbignc2Nyb2xsZW5kJywgZnVuY3Rpb24oZSl7DQogICAgICAgIAkJCWxvYWROZXh0KG9wdGlvbnMpOw0KICAgICAgICAJCX0pOw0KCQkJfQ0KICAgIAkJDQogICAgCQlvcHRpb25zLndyYXBwZXIub24oJ2NsaWNrJywgJy5tYXJrIGEnLCBmdW5jdGlvbihlKSB7DQogICAgCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIAkJCXZhciBtYXJrTGluayA9ICQoZS50YXJnZXQpOw0KICAgIAkJCXZhciBub3RpZmljYXRpb25MaW5lSXRlbSA9ICQodGhpcykuY2xvc2VzdCgnbGknKTsNCiAgICAJCQl2YXIgbm90aWZpY2F0aW9uSWQgPSBub3RpZmljYXRpb25MaW5lSXRlbS5kYXRhKCdub3RpZmljYXRpb25pZCcpOw0KICAgIAkJCQ0KICAgIAkJCWlmIChub3RpZmljYXRpb25JZCkgew0KICAgIAkJCSAgICB2YXIgbWFya05vdGlmaWNhdGlvblByb21pc2UgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ucHV0KHsNCiAgICAgICAgCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL25vdGlmaWNhdGlvbi97Tm90aWZpY2F0aW9uSWR9Lmpzb24nLA0KICAgICAgICAJCQkJZGF0YTogew0KICAgICAgICAJCQkJCU5vdGlmaWNhdGlvbklkOiBub3RpZmljYXRpb25JZCwNCiAgICAgICAgCQkJCQlNYXJrQXNSZWFkOiB0cnVlDQogICAgICAgIAkJCQl9DQogICAgICAgIAkJCX0pOw0KICAgIAkJCQltYXJrTm90aWZpY2F0aW9uUHJvbWlzZS50aGVuKGZ1bmN0aW9uKCl7DQogICAgCQkJCQltYXJrTGluay5oaWRlKCk7DQogICAgCQkJCQlub3RpZmljYXRpb25MaW5lSXRlbS5yZW1vdmVDbGFzcygndW5yZWFkJyk7DQogICAgCQkJCX0pOw0KICAgIAkJCX0NCiAgICAJCQlyZXR1cm4gZmFsc2U7DQogICAgCQl9KTsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ25vdGlmaWNhdGlvbi5yYWlzZWQnLCBmdW5jdGlvbihkKSB7DQoJCQkgICAgdmFyIGRhdGEgPSAkLmV4dGVuZCh7fSwgb3B0aW9ucy5xdWVyeSk7DQogICAgICAgIAkJZGF0YVtvcHRpb25zLnBhZ2VJbmRleEtleV0gPSAxOw0KICAgICAgICAJCQ0KICAgICAgICAJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KICAgICAgICAJCQl1cmw6IG9wdGlvbnMubW9yZVVybCwNCiAgICAgICAgCQkJZGF0YTogZGF0YQ0KICAgICAgICAJCX0pDQogICAgICAgIAkJICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXsNCiAgICAgICAgCQkgICAgICAgIHZhciBsYXN0SXRlbSA9IG51bGw7DQogICAgICAgIAkJCQkkKHJlc3BvbnNlKS5maW5kKCdsaS5jb250ZW50LWl0ZW0nKS5lYWNoKGZ1bmN0aW9uKCkgew0KICAgICAgICAJCQkJICAgIHZhciBpdGVtID0gJCh0aGlzKTsNCiAgICAgICAgCQkJCSAgICBvcHRpb25zLmxpc3QuZmluZCgnbGkuY29udGVudC1pdGVtW2RhdGEtbm90aWZpY2F0aW9uaWQ9IicgKyBpdGVtLmRhdGEoJ25vdGlmaWNhdGlvbmlkJykgKyAnIl0nKS5yZW1vdmUoKTsNCiAgICAgICAgCQkJCSAgICBpZiAobGFzdEl0ZW0pIHsNCiAgICAgICAgCQkJCSAgICAgICAgbGFzdEl0ZW0uYWZ0ZXIoaXRlbSk7DQogICAgICAgIAkJCQkgICAgfSBlbHNlIHsNCiAgICAgICAgCQkJCSAgICAgICAgb3B0aW9ucy5saXN0LnByZXBlbmQoaXRlbSk7DQogICAgICAgIAkJCQkgICAgfQ0KICAgICAgICAJCQkJICAgIGxhc3RJdGVtID0gaXRlbTsNCiAgICAgICAgCQkJCX0pOw0KICAgICAgICAJCQkJDQogICAgICAgIAkJCQlpZiAob3B0aW9ucy5tYXhJdGVtcyA+IDApIHsNCiAgICAgICAgCQkJCSAgICB3aGlsZShvcHRpb25zLmxpc3QuY2hpbGRyZW4oKS5sZW5ndGggPiBvcHRpb25zLm1heEl0ZW1zKSB7DQogICAgICAgIAkJCQkgICAgICAgIG9wdGlvbnMubGlzdC5jaGlsZHJlbigpLmxhc3QoKS5yZW1vdmUoKTsNCiAgICAgICAgCQkJCSAgICB9DQogICAgICAgIAkJCQl9DQogICAgICAgIAkJCX0pOw0KCQkJfSk7DQoJCQkNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcuc3Vic2NyaWJlKCdub3RpZmljYXRpb24ucmVhZCcsIGZ1bmN0aW9uKGQpICB7DQoJCSAgICAgICAgdmFyIGl0ZW0gPSBvcHRpb25zLmxpc3QuZmluZCgnLmNvbnRlbnQtaXRlbVtkYXRhLW5vdGlmaWNhdGlvbmlkPSInICsgZC5pZCArICciXScpOw0KCQkgICAgICAgIGlmIChpdGVtLmxlbmd0aCA+IDApIHsNCgkJICAgICAgICAgICAgaWYgKG9wdGlvbnMucXVlcnkud19uciAhPSAnZmFsc2UnKSB7DQoJCSAgICAgICAgICAgICAgICBpdGVtLnJlbW92ZUNsYXNzKCd1bnJlYWQnKS5maW5kKCcubWFyaycpLnJlbW92ZSgpOw0KCQkgICAgICAgICAgICB9IGVsc2Ugew0KCQkgICAgICAgICAgICAgICAgaXRlbS5mYWRlT3V0KDEwMCwgZnVuY3Rpb24oKSB7DQoJCSAgICAgICAgICAgICAgICAgICAgaXRlbS5yZW1vdmUoKTsNCgkJICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5saXN0LmNoaWxkcmVuKCkubGVuZ3RoID09IDApIHsNCgkJICAgICAgICAgICAgICAgICAgICAgICAgcmVzZXQob3B0aW9ucyk7DQoJCSAgICAgICAgICAgICAgICAgICAgfQ0KCQkgICAgICAgICAgICAgICAgfSk7DQoJCSAgICAgICAgICAgIH0NCgkJICAgICAgICB9DQoJCQl9KTsNCgkJCQ0KCQkJaWYgKG9wdGlvbnMuaW5maW5pdGVTY3JvbGwpIHsNCgkJCSAgICBvcHRpb25zLnBhZ2VVbnRpbFNjcm9sbEF0dGVtcHRzID0gNTsNCgkJCSAgICBwYWdlVW50aWxTY3JvbGxzKG9wdGlvbnMpOw0KCQkJfQ0KCQl9DQoJfTsNCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMubm90aWZpY2F0aW9uTGlzdCA9IGFwaTsNCg0KfSkoalF1ZXJ5LCB3aW5kb3cpOw0K</file>
		</files>
	</scriptedContentFragment>
</scriptedContentFragments>