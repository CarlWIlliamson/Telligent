<scriptedContentFragments>
	<scriptedContentFragment name="${resource:User_Notifications_Name}" version="10.1.8.10498" description="${resource:User_Notifications_Description}" instanceIdentifier="064087c399074d4dba630192735509ef" theme="" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-notifications">
		<contentScript><![CDATA[
#set ($user = false)
#set ($user = $core_v2_user.Accessing)

## user must be regisetered to receive notifications
#if (!$user || !$core_v2_user.IsRegistered($user.Id))
	$core_v2_widget.Hide()
#end

#set ($duration = $core_v2_widget.GetIntValue('duration', 10))
#set ($native = $core_v2_widget.GetBoolValue('native', true))

#registerEndOfPageHtml('telligent.evolution.widgets.userNotifications')
	<script type="text/javascript" src="$core_v2_encoding.HtmlAttributeEncode($core_v2_widget.GetFileUrl("ui.js"))"></script>
	<script type="text/javascript">
		jQuery(function(){
			jQuery.telligent.evolution.widgets.userNotifications.register({
				duration: ($duration * 1000),
				native: #if($native) true #else false #end
			})
		});
	</script>
#end
		]]></contentScript>
		<headerScript><![CDATA[
$core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('fragmentHeader', '${resource:User_Notifications_Name}'))
		]]></headerScript>
		<configuration><![CDATA[
<propertyGroup id="options" resourceName="Options">
	<property id="duration" resourceName="Duration" descriptionResourceName="Duration_Description" dataType="int" defaultValue="10">
		<propertyRule type="Telligent.Evolution.Controls.PropertyRules.MinMaxValueRule, Telligent.Evolution.Platform" minValue="1" maxValue="3600" />
	</property>
	<property id="native" resourceName="Native" descriptionResourceName="Native_Description" dataType="bool" defaultValue="true" />
</propertyGroup>
		]]></configuration>
		<languageResources><language key="en-us">
  <resource name="Duration">Duration</resource>
  <resource name="Duration_Description">Seconds to display notification</resource>
  <resource name="Native">Desktop Notifications</resource>
  <resource name="Native_Description">When available, attempt to display desktop notifications.</resource>
  <resource name="Options">Options</resource>
  <resource name="User_Notifications_Description">Displays user notifications as they are received</resource>
  <resource name="User_Notifications_Name">User - Notifications</resource>
</language>
<language key="zh-cn">
  <resource name="Duration">持续时间</resource>
  <resource name="Duration_Description">显示通知的时间(秒)</resource>
  <resource name="Native">桌面通知</resource>
  <resource name="Native_Description">如果可用，则尝试显示桌面通知。</resource>
  <resource name="Options">选项</resource>
  <resource name="User_Notifications_Description">在收到用户通知时显示这些通知</resource>
  <resource name="User_Notifications_Name">用户 - 通知</resource>
</language>
<language key="zh-tw">
  <resource name="Duration">持續時間</resource>
  <resource name="Duration_Description">顯示通知的秒數</resource>
  <resource name="Native">桌面通知</resource>
  <resource name="Native_Description">當可用時，嘗試顯示桌面通知。</resource>
  <resource name="Options">選項</resource>
  <resource name="User_Notifications_Description">顯示收到的使用者通知</resource>
  <resource name="User_Notifications_Name">使用者 - 通知</resource>
</language></languageResources>
		<files>
			<file name="ui.js">KGZ1bmN0aW9uICgkLCBnbG9iYWwpIHsNCg0KCS8vIGVuc3VyZXMgYW4gYWN0aW9uIG9ubHkgb2NjdXJzIG9uY2UgYWNyb3NzIGFsbCB0YWJzIGFuZCB3aW5kb3dzDQoJLy8gIGRvT25jZSh1bmlxdWVLZXksIGZ1bmN0aW9uKCkgeyB9LCBvcHRpb25zKQ0KCS8vICBvcHRpb25zOiAob3B0aW9uYWwpDQoJLy8gICAgZXhwaXJlQWZ0ZXI6IDUwMDANCgkvLyAgICBtYXhXYWl0OiA1MDANCgl2YXIgZG9PbmNlID0gKGZ1bmN0aW9uICgpIHsNCg0KCQl2YXIgYWN0aW9uc1N0b3JhZ2VLZXlOYW1lU3BhY2UgPSAnX3VuaXF1ZV9hY3Rpb25zXycsDQoJCQlnZXQgPSBmdW5jdGlvbiAoa2V5KSB7DQoJCQkJcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSk7DQoJCQl9LA0KCQkJc2V0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsNCgkJCQlsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7DQoJCQl9LA0KCQkJcmVtb3ZlID0gZnVuY3Rpb24gKGtleSkgew0KCQkJCWxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7DQoJCQl9Ow0KDQoJCXZhciBhcGkgPSBmdW5jdGlvbiAoa2V5LCB0YXNrLCBvcHRpb25zKSB7DQoJCQl2YXIgc2V0dGluZ3MgPSAkLmV4dGVuZCh7DQoJCQkJZXhwaXJlQWZ0ZXI6IDUwMDAsDQoJCQkJbWF4V2FpdDogNTAwDQoJCQl9LCBvcHRpb25zIHx8IHt9KTsNCg0KCQkJaWYgKCFnbG9iYWwubG9jYWxTdG9yYWdlKSB7DQoJCQkJc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQoJCQkJCXRhc2soKTsNCgkJCQl9LCA5KTsNCgkJCQlyZXR1cm47DQoJCQl9DQoNCgkJCS8vIHdhaXQgZm9yIGEgc21hbGwgcmFuZG9tIGFtb3VudCBvZiB0aW1lIHRvIGF2b2lkIHJhY2UgY29uZGl0aW9ucyBhY3Jvc3MgdGFicw0KCQkJc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQoJCQkJLy8gaWYgbm8gbG9jYWxzdG9yYWdlIHJlY29yZCBleGlzdHMgb2YgdGhpcyBhY3Rpb24gYmVpbmcgdGFrZW4sDQoJCQkJLy8gcmVjb3JkIGl0IG5vdyBhbmQgaW52b2tlIHRoZSBhY3Rpb24NCgkJCQl2YXIgYWN0aW9uUmVjb3JkID0gZ2V0KGFjdGlvbnNTdG9yYWdlS2V5TmFtZVNwYWNlICsga2V5KTsNCgkJCQlpZiAoIWFjdGlvblJlY29yZCkgew0KCQkJCQlzZXQoYWN0aW9uc1N0b3JhZ2VLZXlOYW1lU3BhY2UgKyBrZXksIHsNCgkJCQkJCWV4cGlyZUFmdGVyOiAobmV3IERhdGUoKSkuZ2V0VGltZSgpICsgc2V0dGluZ3MuZXhwaXJlQWZ0ZXINCgkJCQkJfSk7DQoJCQkJCXRhc2soKTsNCgkJCQl9DQoJCQl9LCBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzZXR0aW5ncy5tYXhXYWl0KSk7DQoJCX07DQoNCgkJaWYgKGdsb2JhbC5sb2NhbFN0b3JhZ2UpIHsNCgkJCS8vIGdhcmJhZ2UtY29sbGVjdCBhY3Rpb24gcmVjb3JkcyB0aGF0IGhhcHBlbmVkIGZhciBlbm91Z2ggaW4gdGhlIHBhc3Qgbm90IHRvIGNhcmUNCgkJCXNldEludGVydmFsKGZ1bmN0aW9uICgpIHsNCgkJCQl2YXIgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsNCgkJCQlmb3IgKHZhciBpID0gMDsgaSA8IGxvY2FsU3RvcmFnZS5sZW5ndGg7IGkrKykgew0KCQkJCQl2YXIgYWN0aW9uS2V5ID0gbG9jYWxTdG9yYWdlLmtleShpKTsNCgkJCQkJaWYgKGFjdGlvbktleS5pbmRleE9mKGFjdGlvbnNTdG9yYWdlS2V5TmFtZVNwYWNlKSA9PT0gMCkgew0KCQkJCQkJdmFyIGFjdGlvblJlY29yZCA9IGdldChhY3Rpb25LZXkpOw0KCQkJCQkJaWYgKGFjdGlvblJlY29yZCAmJiBhY3Rpb25SZWNvcmQuZXhwaXJlQWZ0ZXIgPD0gY3VycmVudFRpbWUpIHsNCgkJCQkJCQlyZW1vdmUoYWN0aW9uS2V5KTsNCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCX0NCgkJCX0sIDEwMDApOw0KCQl9DQoNCgkJcmV0dXJuIGFwaTsNCgl9KSgpOw0KDQoJLy8gdmFyIG5vdGlmaWVyID0gbmF0aXZlTm90aWZpZXIoKTsNCgkvLyBub3RpZmllci5ub3RpZnkoeyAgfSk7DQoJLy8gICAgdGl0bGU6IG51bGwsDQoJLy8gICAgYm9keTogbnVsbCwNCgkvLyAgICBpY29uVXJsOiBudWxsLA0KCS8vICAgIHRhZzogbnVsbCwNCgkvLyAgICBvbmNsaWNrOiBudWxsLA0KCS8vICAgIG9uY2xvc2U6IG51bGwsDQoJLy8gICAgb25zaG93OiBudWxsDQoJdmFyIE5hdGl2ZU5vdGlmaWVyID0gKGZ1bmN0aW9uICgpIHsNCgkJdmFyIG9wZW5OYXRpdmVOb3RpZmljYXRpb25zID0gW10sDQoJCQljbGVhbnVwUmVnaXN0ZXJlZCA9IGZhbHNlOw0KDQoJCWZ1bmN0aW9uIHJlZ2lzdGVyVW5sb2FkQ2xlYW51cCgpIHsNCgkJCWlmKGNsZWFudXBSZWdpc3RlcmVkKSB7IHJldHVybjsgfQ0KCQkJY2xlYW51cFJlZ2lzdGVyZWQgPSB0cnVlOw0KDQoJCQkkKGdsb2JhbCkudW5sb2FkKGZ1bmN0aW9uKCkgew0KCQkJCSQuZWFjaChvcGVuTmF0aXZlTm90aWZpY2F0aW9ucywgZnVuY3Rpb24oaSwgbmF0aXZlTm90aWZpY2F0aW9uKXsNCgkJCQkJbmF0aXZlTm90aWZpY2F0aW9uLmNsb3NlKCk7DQoJCQkJfSk7DQoJCQl9KTsNCgkJfQ0KDQoJCWZ1bmN0aW9uIGVuYWJsZSgpIHsNCgkJCWlmIChnbG9iYWwuTm90aWZpY2F0aW9uICYmIGdsb2JhbC5Ob3RpZmljYXRpb24ucGVybWlzc2lvbiAhPT0gImdyYW50ZWQiKSB7DQoJCQkJZ2xvYmFsLk5vdGlmaWNhdGlvbi5yZXF1ZXN0UGVybWlzc2lvbihmdW5jdGlvbiAoc3RhdHVzKSB7DQoJCQkJCWlmIChnbG9iYWwuTm90aWZpY2F0aW9uLnBlcm1pc3Npb24gIT09IHN0YXR1cykgew0KCQkJCQkJZ2xvYmFsLk5vdGlmaWNhdGlvbi5wZXJtaXNzaW9uID0gc3RhdHVzOw0KCQkJCQl9DQoJCQkJfSk7DQoJCQl9DQoJCX0NCg0KCQlmdW5jdGlvbiBub3RpZnkob3B0aW9ucykgew0KCQkJc2V0dGluZ3MgPSAkLmV4dGVuZCh7fSwgew0KCQkJCWtleTogbnVsbCwNCgkJCQl0aXRsZTogbnVsbCwNCgkJCQlib2R5OiBudWxsLA0KCQkJCWljb25Vcmw6IG51bGwsDQoJCQkJdGFnOiBudWxsLA0KCQkJCW9uY2xpY2s6IG51bGwsDQoJCQkJb25jbG9zZTogbnVsbCwNCgkJCQlvbnNob3c6IG51bGwsDQoJCQkJaGlkZUFmdGVyOiAyMDAwDQoJCQl9LCBvcHRpb25zKTsNCg0KCQkJdmFyIHJlbmRlck5vdGlmaWNhdGlvbiA9IGZ1bmN0aW9uICgpIHsNCgkJCQl2YXIgbm90ZTsNCgkJCQlpZiAoZ2xvYmFsLk5vdGlmaWNhdGlvbiAmJiBnbG9iYWwuTm90aWZpY2F0aW9uLnBlcm1pc3Npb24gPT09ICJncmFudGVkIikgew0KCQkJCQlub3RlID0gbmV3IGdsb2JhbC5Ob3RpZmljYXRpb24oc2V0dGluZ3MudGl0bGUsIHsNCgkJCQkJCWljb246IHNldHRpbmdzLmljb25VcmwgfHwgIiIsDQoJCQkJCQlib2R5OiBzZXR0aW5ncy5ib2R5IHx8ICIiLA0KCQkJCQkJdGFnOiBzZXR0aW5ncy50YWcNCgkJCQkJfSk7DQoJCQkJCWlmIChzZXR0aW5ncy5vbmNsaWNrKSB7DQoJCQkJCQlub3RlLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7DQoJCQkJCQkJZ2xvYmFsLmZvY3VzKCk7DQoJCQkJCQkJc2V0dGluZ3Mub25jbGljaygpOw0KCQkJCQkJfTsNCgkJCQkJfQ0KCQkJCQlpZiAoc2V0dGluZ3Mub25jbG9zZSkgeyBub3RlLm9uY2xvc2UgPSBzZXR0aW5ncy5vbmNsb3NlOyB9DQoJCQkJCWlmIChzZXR0aW5ncy5vbnNob3cpIHsgbm90ZS5vbnNob3cgPSBzZXR0aW5ncy5vbnNob3c7IH0NCgkJCQl9DQoJCQkJaWYgKG5vdGUpIHsNCgkJCQkJb3Blbk5hdGl2ZU5vdGlmaWNhdGlvbnMucHVzaChub3RlKTsNCgkJCQkJc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQoJCQkJCQlpZiAobm90ZS5jbG9zZSkgew0KCQkJCQkJCW5vdGUuY2xvc2UoKTsNCgkJCQkJCQlvcGVuTmF0aXZlTm90aWZpY2F0aW9ucy5zcGxpY2Uob3Blbk5hdGl2ZU5vdGlmaWNhdGlvbnMuaW5kZXhPZihub3RlKSwgMSk7DQoJCQkJCQl9DQoJCQkJCX0sIHNldHRpbmdzLmhpZGVBZnRlcik7DQoJCQkJCXJlZ2lzdGVyVW5sb2FkQ2xlYW51cCgpOw0KCQkJCX0NCgkJCX07DQoNCgkJCS8vIGlmIHRoZXJlJ3MgYSB1bmlxdWUga2V5LCBvbmx5IHJhaXNlIG9uY2UgcGVyIGFsbCB0YWJzDQoJCQlpZiAoc2V0dGluZ3Mua2V5KSB7DQoJCQkJZG9PbmNlKHNldHRpbmdzLmtleSwgcmVuZGVyTm90aWZpY2F0aW9uKTsNCgkJCX0gZWxzZSB7DQoJCQkJcmVuZGVyTm90aWZpY2F0aW9uKCk7DQoJCQl9DQoJCX07DQoNCgkJcmV0dXJuIGZ1bmN0aW9uICgpIHsNCgkJCS8vIGF0dGVtcHQgdG8gcmVxdWVzdCBwZXJtaXNzaW9uIG9uIHVzZXIgZ2VzdHVyZSBpZiBub3QgYWxyZWFkeSBncmFudGVkDQoJCQkkKGZ1bmN0aW9uICgpIHsNCgkJCQkkKCdib2R5Jykub25lKCdjbGljaycsIGVuYWJsZSkNCgkJCQkJLm9uZSgna2V5ZG93bicsIGVuYWJsZSk7DQoJCQl9KTsNCgkJCXJldHVybiB7DQoJCQkJbm90aWZ5OiBub3RpZnkNCgkJCX07DQoJCX0NCg0KCX0pKCk7DQoNCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24gKG9wdGlvbnMpIHsNCg0KCQkJdmFyIG5hdGl2ZU5vdGlmaWVyOw0KCQkJaWYgKG9wdGlvbnMubmF0aXZlICYmICFuYXRpdmVOb3RpZmllcikgew0KCQkJCW5hdGl2ZU5vdGlmaWVyID0gTmF0aXZlTm90aWZpZXIoKTsNCgkJCX0NCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ25vdGlmaWNhdGlvbi5yYWlzZWQnLCBmdW5jdGlvbiAoZGF0YSkgew0KCQkJCWlmKGRhdGEuc3VwcHJlc3MgPT09IHRydWUpDQoJCQkJCXJldHVybjsNCg0KCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5ub3RpZmljYXRpb25zLnNob3coZGF0YS5tZXNzYWdlLCB7DQoJCQkJCWlkOiBkYXRhLmlkLA0KCQkJCQlkdXJhdGlvbjogb3B0aW9ucy5kdXJhdGlvbiwNCgkJCQkJb25DbG9zZTogZnVuY3Rpb24gKCkgew0KCQkJCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5wdXQoew0KCQkJCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL25vdGlmaWNhdGlvbi97Tm90aWZpY2F0aW9uSWR9Lmpzb24nLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJTm90aWZpY2F0aW9uSWQ6IGRhdGEuaWQsDQoJCQkJCQkJCU1hcmtBc1JlYWQ6IHRydWUNCgkJCQkJCQl9DQoJCQkJCQl9KTsNCgkJCQkJfSwNCgkJCQkJb25DbGljazogZnVuY3Rpb24gKCkgew0KCQkJCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5wdXQoew0KCQkJCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL25vdGlmaWNhdGlvbi97Tm90aWZpY2F0aW9uSWR9Lmpzb24nLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJTm90aWZpY2F0aW9uSWQ6IGRhdGEuaWQsDQoJCQkJCQkJCU1hcmtBc1JlYWQ6IHRydWUNCgkJCQkJCQl9DQoJCQkJCQl9KS50aGVuKGZ1bmN0aW9uICgpIHsNCgkJCQkJCQl0cnkgew0KCQkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24udXJsLm5hdmlnYXRlVG8oZGF0YS5jb250ZW50VXJsKTsNCgkJCQkJCQl9IGNhdGNoIChlKSB7DQoJCQkJCQkJCXdpbmRvdy5sb2NhdGlvbi5ocmVmID0gZGF0YS5jb250ZW50VXJsOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9DQoJCQkJfSk7DQoNCgkJCQlpZiAob3B0aW9ucy5uYXRpdmUpIHsNCgkJCQkJbmF0aXZlTm90aWZpZXIubm90aWZ5KHsNCgkJCQkJCWtleTogKGRhdGEuaWQgKyBkYXRhLmNvbnRlbnRVcmwgKyBkYXRhLm1lc3NhZ2UpLA0KCQkJCQkJdGl0bGU6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5odG1sLmRlY29kZShkYXRhLm1lc3NhZ2UpLA0KCQkJCQkJaWNvblVybDogZGF0YS5hdmF0YXJVcmwsDQoJCQkJCQl0YWc6ICdub3RpZmljYXRpb24tJyArIGRhdGEuaWQsDQoJCQkJCQloaWRlQWZ0ZXI6IG9wdGlvbnMuZHVyYXRpb24sDQoJCQkJCQlvbmNsaWNrOiBmdW5jdGlvbiAoKSB7DQoJCQkJCQkJdHJ5IHsNCgkJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnVybC5uYXZpZ2F0ZVRvKGRhdGEuY29udGVudFVybCk7DQoJCQkJCQkJfSBjYXRjaCAoZSkgew0KCQkJCQkJCQl3aW5kb3cubG9jYXRpb24uaHJlZiA9IGRhdGEuY29udGVudFVybDsNCgkJCQkJCQl9DQoJCQkJCQl9DQoJCQkJCX0pOw0KCQkJCX0NCgkJCX0pOw0KCQl9DQoJfTsNCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMudXNlck5vdGlmaWNhdGlvbnMgPSBhcGk7DQoNCn0pKGpRdWVyeSwgd2luZG93KTsNCg==</file>
		</files>
	</scriptedContentFragment>
</scriptedContentFragments>